# Правила проекта STT-app

## Обязательные действия после внесения изменений

### 1. Пересборка и перезапуск контейнеров

После успешного внесения изменений в код, которые затрагивают:
- Backend (Python код в `backend/app/`)
- Frontend (React код в `frontend/src/`)
- Docker конфигурацию (`docker-compose.yml`, `Dockerfile`)

**ОБЯЗАТЕЛЬНО** выполнить:

1. Пересобрать затронутые контейнеры:
   ```bash
   docker-compose build <service_name>
   ```
   Где `<service_name>` - это `backend` или `frontend` в зависимости от изменений.

2. Перезапустить затронутые контейнеры:
   ```bash
   docker-compose restart <service_name>
   ```

3. Проверить статус контейнеров:
   ```bash
   docker-compose ps
   ```

4. Проверить логи на наличие ошибок:
   ```bash
   docker logs <service_name> --tail 50
   ```

### 2. Git commit после изменений

После успешного внесения изменений и перезапуска контейнеров **ОБЯЗАТЕЛЬНО** сделать git commit с говорящим комментарием.

**Требования к commit message:**

1. Использовать русский язык для описания изменений
2. Первая строка должна быть кратким описанием (до 72 символов)
3. При необходимости добавить подробное описание после пустой строки
4. Указывать, какие компоненты были изменены (backend/frontend)
5. Указывать основную цель изменений

**Примеры хороших commit messages:**

```
Добавлена возможность копирования ответов RAG в markdown формате

- Добавлена кнопка копирования ответа ассистента
- Добавлена кнопка копирования всех источников в markdown
- Добавлен компонент CopyButton с визуальной обратной связью
- Изменения в frontend: RAGChatPage.jsx, RAGChatPage.css
```

```
Исправлена оценка качества RAG ответов для сложных настроек

- Исправлена логика length_penalty_reduction для reranking + hybrid search
- Увеличены максимальные значения penalty reduction
- Улучшен chunk_factor для сложных настроек
- Добавлено подробное логирование промежуточных значений
- Изменения в backend: rag_qa_service.py
```

```
Добавлен markdown рендеринг для summaries

- Заменен простой текст на ReactMarkdown компонент
- Добавлена возможность сворачивать/разворачивать summaries
- Изменения в frontend: TranscriptDetailPage.jsx, TranscriptDetailPage.css
```

**Команда для создания commit:**

```bash
git add .
git commit -m "Краткое описание

Подробное описание изменений:
- Пункт 1
- Пункт 2
- Пункт 3"
```

## Порядок действий

1. Внести изменения в код
2. Проверить код на ошибки (linter, syntax)
3. Пересобрать и перезапустить затронутые контейнеры
4. Проверить работу изменений
5. Создать git commit с говорящим комментарием

## Исключения

Не требуется пересборка контейнеров для:
- Изменений только в документации (`.md` файлы)
- Изменений только в конфигурационных файлах, не требующих перезапуска
- Изменений в `.gitignore`, `.cursorrules` и подобных файлах

Но git commit все равно обязателен для отслеживания прогресса разработки.

